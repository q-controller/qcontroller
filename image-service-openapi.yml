info:
  description: This is the OpenAPI schema for VM image service API
  title: VM Image Service
  version: v1
openapi: 3.0.3
paths:
  /v1/images:
    get:
      description: Retrieves a list of all available images
      responses:
        "200":
          description: List of images retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImageListResponse'
        "500":
          description: Internal server error
      summary: List images
      tags:
        - ImageService
    post:
      description: Uploads an image file with an associated ID
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/ImageUploadRequest'
        required: true
      responses:
        "200":
          description: Upload successful
        "400":
          description: Bad request - missing parameters or invalid file
        "500":
          description: Internal server error
      summary: Upload image
      tags:
        - ImageService
  /v1/images/{imageId}:
    delete:
      description: Removes an image by its ID
      parameters:
        - description: The ID of the image to delete
          in: path
          name: imageId
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Image deleted successfully
        "400":
          description: Bad request - missing or invalid imageId
        "500":
          description: Internal server error
      summary: Delete image
      tags:
        - ImageService
components:
  schemas:
    ImageInfo:
      type: object
      properties:
        image_id:
          type: string
          description: Unique identifier for the image
        hash:
          type: string
          description: SHA256 hash of the image
        size:
          type: integer
          format: int64
          description: Size of the image in bytes
        uploaded_at:
          type: string
          format: date-time
          description: Timestamp when the image was uploaded
      required:
        - image_id
        - hash
        - size
        - uploaded_at
    ImageListResponse:
      type: object
      properties:
        images:
          type: array
          description: Array of image metadata objects
          items:
            $ref: '#/components/schemas/ImageInfo'
    ImageUploadRequest:
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the image
        file:
          type: string
          format: binary
          description: The image file to upload
      required:
        - id
        - file
tags:
  - name: ImageService
